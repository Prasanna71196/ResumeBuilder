<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Resume Builder | Details</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@100;700&family=Pacifico&family=Quicksand:wght@300;700&family=Roboto&family=Volkhov&display=swap" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet" />
<link href="{% static 'css/styles.css' %}" rel="stylesheet" />
<style>
  .footer-large { background: #047857; color: #fff; width: 100%; padding-top: 46px; padding-bottom: 32px; margin-top: 48px; font-family: 'Poppins', Arial, sans-serif;}
  .footer-content-wrap { display: flex; flex-wrap: wrap; max-width: 1600px; margin: 0 auto; justify-content: flex-start; gap: 60px;}
  .footer-brand-block, .brand-logo { display: flex; align-items: center; gap: 12px; min-width: 230px; margin-bottom: 35px;}
  .footer-link-block { display: flex; gap: 85px; flex: 1; justify-content: flex-start; }
  .footer-link-block > div { display: flex; flex-direction: column; gap: 5px; min-width: 180px;}
  .footer-section-title { color: #b9bccb; font-weight: 600; margin-bottom: 8px; letter-spacing: 0.7px; text-transform: uppercase; margin-top: 5px;}
  .footer-link-block a { color: #fff; text-decoration: none; transition: color 0.15s; font-weight: 400; margin-bottom: 5px; font-size: 1.06em;}
  .footer-link-block a:hover { color: #56a0f3; text-decoration: underline;}
  .footer-bottom-row { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: baseline; gap: 36px; max-width: 1600px; margin: 40px auto 0 auto; padding-top: 35px; border-top: 1.7px solid #27293a;}
  .footer-socmed-row a { color: #b9bccb; font-size: 1.23em; margin: 1px 9px; text-decoration: none; transition: color 0.14s; display: inline-block;}
  .footer-socmed-row a:hover { color: white; background: #047857; border-radius: 50%; }
  @media (max-width: 1100px) { .footer-content-wrap, .footer-bottom-row { flex-direction: column; gap: 18px; align-items: flex-start; } .footer-link-block { flex-direction: column; gap: 28px; } .footer-bottom-row { align-items: flex-start; } }
  @media (max-width: 650px) { .footer-large { padding: 30px 0 16px 0; } .footer-content-wrap, .footer-bottom-row { flex-direction: column; gap: 12px; padding: 0 13px; } .footer-brand-block, .footer-link-block > div { min-width: unset; } }
  .brand-logo { display: flex; align-items: center; font-family: 'Poppins', 'Segoe UI', Arial, sans-serif; font-weight: 700; font-size: 1.45rem; gap: 10px; }
  .brand-logo a { display: flex; align-items: center; text-decoration: none; }
  .brand-img { height: 40px; width: 40px; border-radius: 8px; box-shadow: 0 1.5px 5px rgba(0,0,0,0.15); margin-right: 8px; background: #fff; object-fit: cover; }
  .brand-text { color: #232a3a; font-size: 1.21em; letter-spacing: 0.5px;}
  .brand-highlight { color: white; font-weight: 800; margin-left: 3px; letter-spacing: 1px;}
  .footer .brand-text { color: #fafbfa; }
  .footer .brand-highlight { color: #75cbd3; }
</style>
</head>
<body>
  <header class="header">
    <div class="brand-logo">
      <a href="{% url 'home' %}">
        <img src="{% static 'images/logo.png' %}" alt="Vetri Templates Logo" class="brand-img">
        <span class="brand-text">Vetri <span class="brand-highlight">Templates</span></span>
      </a>
    </div>
    <nav>
      <a href="{% url 'home' %}">Home</a>
      <a href="{% url 'templates' %}">Templates</a>
      <a href="{% url 'details' %}">Details</a>
      <a href="{% url 'resume' %}">Resume</a>
    </nav>
    <div id="nav-user"></div>
    <button onclick="logout()" style="margin-left:16px; background:#047857; color:white; border:none; border-radius:5px; padding:5px 18px; cursor:pointer;">Logout</button>
  </header>
  <div class="main-content">
    <h2>Fill in Your Resume Details</h2>
    <div class="progress-bar-container">
      <div class="progress-bar-bg">
        <div class="progress-bar-fill" id="progressBar"></div>
      </div>
      <div class="progress-label" id="progressLabel">Personal Details (1/6)</div>
    </div>
    <form id="detailsForm">
      <div class="details-section active" id="section-personal">
        <h2>Personal Info</h2>
        <input type="text" name="name" placeholder="Full Name" required />
        <input type="email" name="email" placeholder="Email" required />
        <input type="text" name="phone" placeholder="Phone" required />
        <input type="text" name="address" placeholder="Address" required />
        <input type="text" name="location" placeholder="Location" required />
        <input type="file" accept="image/*" onchange="previewPhoto(event)" />
        <img id="photo-preview" style="display:none; margin:12px 0;" width="90" />
        <textarea name="summary" placeholder="Professional Summary"></textarea>
        <input type="text" name="techstack" placeholder="Tech Stack (comma separated)" />
      </div>
      <div class="details-section" id="section-skills">
        <h2>Skills</h2>
        <input type="text" name="skills" placeholder="Skills (comma separated)" required />
      </div>
      <div class="details-section" id="section-experience">
        <h2>Experience</h2>
        <div id="companies"></div>
        <button type="button" class="add-btn" onclick="addCompany()">Add Company</button>
      </div>
      <div class="details-section" id="section-certifications">
        <h2>Certifications & Awards</h2>
        <input type="text" name="certifications" placeholder="Certifications (comma separated)" />
        <input type="text" name="awards" placeholder="Awards (comma separated)" />
        <textarea name="achievements" placeholder="Key Achievements"></textarea>
      </div>
      <div class="details-section" id="section-education">
        <h2>Education</h2>
        <label>10th</label>
        <input type="text" name="school_10" placeholder="School Name" required />
        <input type="text" name="marks_10" placeholder="Marks/CGPA" />
        <input type="text" name="location_10" placeholder="Location" />
        <label>12th</label>
        <input type="text" name="school_12" placeholder="School Name" />
        <input type="text" name="marks_12" placeholder="Marks/CGPA" />
        <input type="text" name="location_12" placeholder="Location" />
        <label>College</label>
        <input type="text" name="college" placeholder="College Name" />
        <input type="text" name="marks_college" placeholder="Marks/CGPA" />
        <input type="text" name="location_college" placeholder="Location" />
      </div>
      <div class="details-section" id="section-review">
        <h2>Review</h2>
        <p>Click Submit to preview the resume</p>
      </div>
      <div class="details-action-btns">
        <button type="button" id="prevBtn" style="display:none;" onclick="prev()">Previous</button>
        <button type="button" id="nextBtn" onclick="next()">Next</button>
        <button type="submit" id="submitBtn" style="display:none;">Submit</button>
      </div>
    </form>
  </div>
  <footer class="footer-large">
    <div class="footer-content-wrap">
      <div class="brand-logo">
        <a href="{% url 'home' %}">
          <img src="{% static 'images/logo.png' %}" alt="Vetri Templates Logo" class="brand-img">
          <span class="brand-text">Vetri <span class="brand-highlight">Templates</span></span>
        </a>
      </div>
      <div class="footer-link-block">
        <div>
          <div class="footer-section-title">RESUME</div>
          <a href="#">AI Resume Builder</a>
          <a href="#">ATS Scorer</a>
          <a href="#">Resume Examples</a>
          <a href="#">Resume Templates</a>
          <div class="footer-section-title" style="margin-top:20px;">COVER LETTER</div>
          <a href="#">Cover Letter Examples</a>
          <a href="#">Cover Letter Templates</a>
        </div>
        <div>
          <div class="footer-section-title">JOB SEEKERS</div>
          <a href="#">Job Search</a>
          <div class="footer-section-title" style="margin-top:20px;">RESOURCES</div>
          <a href="#">Blog</a>
          <a href="#">Resume Help</a>
          <a href="#">Job Interview</a>
          <a href="#">Career</a>
          <a href="#">Writing A Resume</a>
          <a href="#">Writing A Cover Letter</a>
        </div>
        <div>
          <div class="footer-section-title">OUR COMPANY</div>
          <a href="#">About Us</a>
          <a href="#">Pricing</a>
          <a href="#">Updates</a>
          <a href="#">Sponsorship Program</a>
          <a href="#">Media Kit</a>
          <a href="#">Affiliates</a>
        </div>
        <div>
          <div class="footer-section-title">SUPPORT</div>
          <a href="#">FAQ</a>
          <a href="#">Contact Us</a>
          <a href="#">Terms Of Service</a>
          <a href="#">Privacy</a>
          <a href="#">Right Of Withdrawal</a>
          <a href="#">Do Not Sell, Do Not Share</a>
          <a href="#">Your Privacy Choices</a>
        </div>
      </div>
    </div>
  </footer>
  <script>
    let curr = 0;
    const sections = [
      "section-personal",
      "section-skills",
      "section-experience",
      "section-certifications",
      "section-education",
      "section-review",
    ];
    const titles = [
      "Personal Info",
      "Skills",
      "Experience",
      "Certifications",
      "Education",
      "Review",
    ];
    function showSection(index) {
      document.querySelectorAll(".details-section").forEach((sec, i) => {
        sec.classList.toggle("active", i === index);
      });
      document.getElementById("prevBtn").style.display = index === 0 ? "none" : "inline-block";
      document.getElementById("nextBtn").style.display = index === sections.length - 1 ? "none" : "inline-block";
      document.getElementById("submitBtn").style.display = index === sections.length - 1 ? "inline-block" : "none";
      document.getElementById("progressBar").style.width = `${((index + 1) / sections.length) * 100}%`;
      document.getElementById("progressLabel").textContent = `${titles[index]} (${index + 1}/${sections.length})`;
    }
    function next() {
      if (curr < sections.length - 1) {
        curr++;
        showSection(curr);
      }
    }
    function prev() {
      if (curr > 0) {
        curr--;
        showSection(curr);
      }
    }
    let companyCount = 0;
    function addCompany() {
      companyCount++;
      const container = document.getElementById("companies");
      const div = document.createElement("div");
      div.className = "company-block";
      div.innerHTML = `
      <div>
        <h3>Company ${companyCount}</h3>
        <input type="text" name="company_name_${companyCount}" placeholder="Company Name" required />
        <input type="text" name="designation_${companyCount}" placeholder="Designation" required />
        <input type="month" name="start_date_${companyCount}" placeholder="Start Date" required />
        <input type="month" name="end_date_${companyCount}" placeholder="End Date" />
        <input type="number" name="years_${companyCount}" placeholder="Years of Experience" min="0" step="0.1" />
        <input type="text" name="company_location_${companyCount}" placeholder="Location" />
        <textarea name="description_${companyCount}" placeholder="Description"></textarea>
        <input type="text" name="certifications_${companyCount}" placeholder="Certifications (comma separated)" />
        <div id="projects_${companyCount}"></div>
        <button type="button" onclick="addProject(${companyCount})">Add Project</button>
        <button type="button" onclick="div.remove()">Remove Company</button>
      </div>`;
      container.appendChild(div);
    }
    function addProject(companyIndex) {
      const projectsDiv = document.getElementById(`projects_${companyIndex}`);
      const projectCount = projectsDiv.querySelectorAll(".project-block").length + 1;
      const div = document.createElement("div");
      div.className = "project-block";
      div.innerHTML = `
      <div>
        <input type="text" name="project_name_${companyIndex}_${projectCount}" placeholder="Project Name" />
        <input type="text" name="certification_${companyIndex}_${projectCount}" placeholder="Certification Received" />
        <button type="button" onclick="div.remove()">Remove Project</button>
      </div>`;
      projectsDiv.appendChild(div);
    }
    function previewPhoto(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          document.getElementById("photo-preview").src = e.target.result;
          document.getElementById("photo-preview").style.display = "block";
          localStorage.setItem("photo", e.target.result);
        };
        reader.readAsDataURL(file);
      }
    }
    document.getElementById("nav-user").textContent = `Welcome, ${
      localStorage.getItem("current_user") || ""
    }`;
    if (!localStorage.getItem("logged_in")) {
      window.location.href = "{% url 'home' %}";
    }
    showSection(curr);
    if (companyCount === 0) addCompany();
    document.getElementById("detailsForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      let data = {};
      formData.forEach((val, key) => {
        data[key] = val;
      });
      data.photo = localStorage.getItem("photo") || "";
      localStorage.setItem("resume_data", JSON.stringify(data));
      const chosenTemplate = localStorage.getItem("chosen_template");
      if (chosenTemplate === "1") {
        window.location.href = "/template1";
      } else if (chosenTemplate === "2") {
        window.location.href = "/template2";
      } else if (chosenTemplate === "3") {
        window.location.href = "/template3";
      } else {
        window.location.href = "/resume";
      }
    });
    function logout() {
      localStorage.removeItem("logged_in");
      window.location.href = "{% url 'home' %}";
    }
  </script>
</body>
</html>
